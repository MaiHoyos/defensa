<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Defensa TFM - Zython (15 diapositivas)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    * { font-family: 'Fredoka', sans-serif; }

    :root{
      --card: rgba(255,255,255,.10);
      --border: rgba(255,255,255,.18);
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 24px;
      --accent: #60a5fa;
      --accent2:#a78bfa;
    }

    :focus-visible{
      outline: 3px solid rgba(96,165,250,.8);
      outline-offset: 3px;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    body {
      background: linear-gradient(-45deg, #1a0b2e, #16213e, #0f3460, #533483);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      padding-top: 92px;
      overflow-x: hidden;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-18px); }
    }

    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 30px rgba(59, 130, 246, 0.6), 0 0 60px rgba(147, 51, 234, 0.4); }
      50% { box-shadow: 0 0 50px rgba(59, 130, 246, 0.9), 0 0 90px rgba(147, 51, 234, 0.6); }
    }

    @keyframes fadeInScale {
      from { opacity: 0; transform: translateY(30px) scale(0.96); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    @keyframes titleGlow {
      0%, 100% {
        text-shadow: 0 0 20px rgba(59, 130, 246, 0.8),
                     0 0 40px rgba(147, 51, 234, 0.6),
                     0 0 60px rgba(236, 72, 153, 0.4);
      }
      50% {
        text-shadow: 0 0 30px rgba(59, 130, 246, 1),
                     0 0 60px rgba(147, 51, 234, 0.8),
                     0 0 90px rgba(236, 72, 153, 0.6);
      }
    }

    .title-hero { animation: titleGlow 3s ease-in-out infinite; }
    .animate-float { animation: float 4s ease-in-out infinite; }
    .animate-pulse-glow { animation: pulse-glow 3s ease-in-out infinite; }
    .animate-fade-in-scale { animation: fadeInScale 0.8s ease-out; }
    .animate-fade-in { animation: fadeIn 1.2s ease-out; }

    .stars {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
      transition: transform .2s ease;
    }
    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 3s infinite;
      box-shadow: 0 0 4px rgba(255, 255, 255, 0.8);
    }
    @keyframes twinkle {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    .glass-card {
      background: var(--card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
    }

    .btn-3d {
      transition: all 0.3s ease;
      box-shadow: 0 6px 0 rgba(0, 0, 0, 0.3), 0 10px 20px rgba(0, 0, 0, 0.2);
    }
    .btn-3d:hover { transform: translateY(-2px); box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3), 0 15px 30px rgba(0, 0, 0, 0.3); }
    .btn-3d:active { transform: translateY(2px); box-shadow: 0 2px 0 rgba(0, 0, 0, 0.3), 0 5px 10px rgba(0, 0, 0, 0.2); }

    .btn-premium { position: relative; overflow: hidden; }
    .btn-premium::after{
      content:"";
      position:absolute;
      inset:-120%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.22), transparent);
      transform: rotate(25deg) translateX(-40%);
      transition: transform .6s ease;
      pointer-events: none;
    }
    .btn-premium:hover::after{ transform: rotate(25deg) translateX(40%); }

    .text-glow { text-shadow: 0 0 20px rgba(59, 130, 246, 0.5); }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: .55rem;
      padding: .55rem .9rem;
      border-radius: 9999px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.16);
      backdrop-filter: blur(10px);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      transition: transform .25s ease, background .25s ease;
    }
    .pill:hover{ transform: translateY(-2px); background: rgba(255,255,255,.14); }

    .step-counter {
      font-weight: 800;
      letter-spacing: .5px;
      color: rgba(255,255,255,.78);
    }

    .float-card {
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 22px;
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      backdrop-filter: blur(18px);
      transition: transform .35s ease, box-shadow .35s ease, border-color .35s ease;
      position: relative;
      overflow: hidden;
    }
    .float-card::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(circle at 30% 20%, rgba(96,165,250,.35), transparent 55%),
                  radial-gradient(circle at 80% 70%, rgba(167,139,250,.28), transparent 55%);
      opacity:.65;
      pointer-events:none;
    }
    .float-card:hover{
      transform: translateY(-8px) scale(1.02);
      border-color: rgba(255,255,255,.28);
      box-shadow: 0 22px 80px rgba(0,0,0,.55);
    }
    .float-card .tag{
      display:inline-flex;
      align-items:center;
      gap:.5rem;
      font-weight:700;
      padding:.35rem .7rem;
      border-radius:9999px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
    }
    .float-orb{
      position:absolute;
      width: 140px; height: 140px;
      border-radius: 9999px;
      opacity:.9;
      pointer-events:none;
      mix-blend-mode: screen;
      animation: float 5s ease-in-out infinite;
    }
    .float-orb.one{ right:-40px; top:-40px; background: radial-gradient(circle, rgba(96,165,250,.45), transparent 65%); }
    .float-orb.two{ left:-45px; bottom:-45px; background: radial-gradient(circle, rgba(167,139,250,.45), transparent 65%); animation-duration: 6.2s; }

    #product-modal{
      position: fixed;
      inset: 0;
      z-index: 99999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }
    #product-modal.show{ display:flex; }
    #product-modal-backdrop{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.72);
      backdrop-filter: blur(10px);
    }
    .product-modal-panel{
      position: relative;
      z-index: 2;
      width: min(1200px, 96vw);
      height: min(720px, 86vh);
      border-radius: 26px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,.16);
      box-shadow: 0 25px 80px rgba(0,0,0,.65);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(16px);
    }
    .product-modal-topbar{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: .75rem;
      padding: .75rem .9rem;
      background: rgba(255,255,255,.06);
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .product-modal-title{
      font-weight: 800;
      color: rgba(255,255,255,.92);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .product-modal-actions{
      display:flex;
      align-items:center;
      gap: .5rem;
    }
    .product-modal-btn{
      padding: .55rem .8rem;
      border-radius: 14px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
      font-weight: 800;
      transition: .2s ease;
    }
    .product-modal-btn:hover{ background: rgba(255,255,255,.18); }
    .product-iframe{
      width: 100%;
      height: calc(100% - 54px);
      border: 0;
      background: rgba(0,0,0,.2);
    }
    @media (max-width: 768px){
      .product-modal-panel{ height: min(720px, 90vh); }
    }

    /* ========== EFECTOS FUTURISTAS MEGA DINAMICOS ========== */

    /* Scanlines overlay - mas visible */
    .scanlines {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 1;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(96,165,250,0.015) 2px,
        rgba(96,165,250,0.015) 4px
      );
      animation: scanlineScroll 8s linear infinite;
    }
    @keyframes scanlineScroll {
      0% { background-position: 0 0; }
      100% { background-position: 0 100vh; }
    }

    /* Particulas flotantes - mas grandes y brillantes */
    .particle {
      position: fixed;
      border-radius: 50%;
      pointer-events: none;
      z-index: 1;
      opacity: 0;
      animation: particleFloat linear infinite;
    }
    @keyframes particleFloat {
      0% { opacity: 0; transform: translateY(100vh) translateX(0px) scale(0.5); }
      10% { opacity: 0.8; }
      50% { transform: translateY(50vh) translateX(60px) scale(1.2); }
      90% { opacity: 0.7; }
      100% { opacity: 0; transform: translateY(-20vh) translateX(-30px) scale(0.3); }
    }

    /* === TRANSICION WARP PRINCIPAL === */
    .slide-transition-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 45;
      opacity: 0;
    }
    .slide-transition-overlay.active-right {
      animation: warpFlashRight 0.8s cubic-bezier(0.22, 1, 0.36, 1);
    }
    .slide-transition-overlay.active-left {
      animation: warpFlashLeft 0.8s cubic-bezier(0.22, 1, 0.36, 1);
    }
    @keyframes warpFlashRight {
      0% { opacity: 1; background: linear-gradient(90deg, transparent, rgba(96,165,250,0.25) 30%, rgba(167,139,250,0.2) 70%, transparent); }
      30% { opacity: 0.8; background: linear-gradient(90deg, transparent, rgba(96,165,250,0.15) 40%, rgba(167,139,250,0.1) 60%, transparent); }
      100% { opacity: 0; }
    }
    @keyframes warpFlashLeft {
      0% { opacity: 1; background: linear-gradient(-90deg, transparent, rgba(96,165,250,0.25) 30%, rgba(167,139,250,0.2) 70%, transparent); }
      30% { opacity: 0.8; }
      100% { opacity: 0; }
    }

    /* === GLITCH OVERLAY en transicion === */
    .glitch-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 46;
      opacity: 0;
      mix-blend-mode: screen;
    }
    .glitch-overlay.active {
      animation: glitchFlicker 0.4s steps(4) forwards;
    }
    @keyframes glitchFlicker {
      0% { opacity: 0.6; background: linear-gradient(0deg, transparent 40%, rgba(96,165,250,0.08) 40.5%, transparent 41%); transform: translateX(-3px); }
      25% { opacity: 0.4; background: linear-gradient(0deg, transparent 60%, rgba(236,72,153,0.06) 60.5%, transparent 61%); transform: translateX(3px) skewX(-0.5deg); }
      50% { opacity: 0.3; background: linear-gradient(0deg, transparent 20%, rgba(167,139,250,0.08) 20.5%, transparent 21%); transform: translateX(-2px) skewX(0.5deg); }
      75% { opacity: 0.15; transform: translateX(1px); }
      100% { opacity: 0; transform: translateX(0); }
    }

    /* === ENERGY RING: anillo de energia en la transicion === */
    .energy-ring {
      position: fixed;
      top: 50%; left: 50%;
      width: 10px; height: 10px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 47;
      border: 2px solid rgba(96,165,250,0.6);
      box-shadow: 0 0 30px rgba(96,165,250,0.3), inset 0 0 30px rgba(96,165,250,0.1);
      opacity: 0;
      transform: translate(-50%, -50%) scale(0);
    }
    .energy-ring.active {
      animation: energyExpand 0.9s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    @keyframes energyExpand {
      0% { opacity: 0.9; transform: translate(-50%, -50%) scale(0); border-color: rgba(96,165,250,0.8); box-shadow: 0 0 60px rgba(96,165,250,0.6), inset 0 0 60px rgba(96,165,250,0.2); }
      40% { opacity: 0.5; transform: translate(-50%, -50%) scale(3); }
      100% { opacity: 0; transform: translate(-50%, -50%) scale(8); border-color: rgba(167,139,250,0.1); box-shadow: 0 0 5px rgba(96,165,250,0); }
    }

    /* === BURST PARTICLES: explosion de particulas al cambiar === */
    .burst-particle {
      position: fixed;
      width: 4px; height: 4px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 46;
      opacity: 0;
    }
    .burst-particle.active {
      animation: burstOut 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    @keyframes burstOut {
      0% { opacity: 1; transform: translate(0,0) scale(1); }
      60% { opacity: 0.6; }
      100% { opacity: 0; transform: var(--burst-dir) scale(0); }
    }

    /* Efecto entrada DRAMATICO para el contenido de cada slide */
    .slide-enter {
      animation: slideEnter 0.85s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
    @keyframes slideEnter {
      0% { opacity: 0; transform: translateY(60px) scale(0.92) rotateX(8deg); filter: blur(12px) brightness(1.5); }
      40% { filter: blur(2px) brightness(1.1); }
      100% { opacity: 1; transform: translateY(0) scale(1) rotateX(0deg); filter: blur(0) brightness(1); }
    }

    /* Efecto warp lateral - MUY dramatico */
    .slide-enter-right {
      animation: slideEnterRight 0.85s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
    @keyframes slideEnterRight {
      0% { opacity: 0; transform: translateX(150px) scale(0.88) rotateY(-12deg) perspective(800px); filter: blur(15px) brightness(1.8); }
      30% { filter: blur(5px) brightness(1.2); }
      100% { opacity: 1; transform: translateX(0) scale(1) rotateY(0deg); filter: blur(0) brightness(1); }
    }
    .slide-enter-left {
      animation: slideEnterLeft 0.85s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
    @keyframes slideEnterLeft {
      0% { opacity: 0; transform: translateX(-150px) scale(0.88) rotateY(12deg) perspective(800px); filter: blur(15px) brightness(1.8); }
      30% { filter: blur(5px) brightness(1.2); }
      100% { opacity: 1; transform: translateX(0) scale(1) rotateY(0deg); filter: blur(0) brightness(1); }
    }

    /* Salida del slide anterior */
    .slide-exit-right {
      animation: slideExitRight 0.5s cubic-bezier(0.55, 0, 1, 0.45) forwards;
    }
    @keyframes slideExitRight {
      0% { opacity: 1; transform: translateX(0) scale(1); filter: blur(0); }
      100% { opacity: 0; transform: translateX(-100px) scale(0.9); filter: blur(10px); }
    }
    .slide-exit-left {
      animation: slideExitLeft 0.5s cubic-bezier(0.55, 0, 1, 0.45) forwards;
    }
    @keyframes slideExitLeft {
      0% { opacity: 1; transform: translateX(0) scale(1); filter: blur(0); }
      100% { opacity: 0; transform: translateX(100px) scale(0.9); filter: blur(10px); }
    }

    /* Grid overlay en transicion - mas visible */
    .grid-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 44;
      opacity: 0;
      background:
        linear-gradient(90deg, rgba(96,165,250,0.06) 1px, transparent 1px),
        linear-gradient(rgba(96,165,250,0.06) 1px, transparent 1px);
      background-size: 60px 60px;
    }
    .grid-overlay.flash {
      animation: gridFlash 1s ease-out;
    }
    @keyframes gridFlash {
      0% { opacity: 1; background-size: 100px 100px; }
      30% { opacity: 0.6; background-size: 70px 70px; }
      100% { opacity: 0; background-size: 60px 60px; }
    }

    /* Shooting stars - mas largas y brillantes */
    .shooting-star {
      position: fixed;
      width: 120px;
      height: 2px;
      background: linear-gradient(90deg, rgba(255,255,255,0.9), rgba(96,165,250,0.5), transparent);
      pointer-events: none;
      z-index: 1;
      opacity: 0;
      animation: shootingStar 1.2s ease-out;
      box-shadow: 0 0 6px rgba(96,165,250,0.4);
    }
    @keyframes shootingStar {
      0% { opacity: 0; transform: translateX(0) translateY(0) rotate(-35deg); width: 20px; }
      10% { opacity: 1; width: 120px; }
      100% { opacity: 0; transform: translateX(400px) translateY(250px) rotate(-35deg); width: 60px; }
    }

    /* Nebula glow - mas intensa */
    .nebula {
      position: fixed;
      width: 500px;
      height: 500px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 0;
      opacity: 0.12;
      filter: blur(80px);
      animation: nebulaDrift 15s ease-in-out infinite alternate;
    }
    @keyframes nebulaDrift {
      0% { transform: translate(0, 0) scale(1); opacity: 0.12; }
      33% { transform: translate(60px, -40px) scale(1.15); opacity: 0.18; }
      66% { transform: translate(-40px, 50px) scale(0.9); opacity: 0.1; }
      100% { transform: translate(30px, -20px) scale(1.05); opacity: 0.15; }
    }

    /* === LIGHT SPEED LINES (al avanzar) === */
    .speed-line {
      position: fixed;
      height: 1px;
      pointer-events: none;
      z-index: 43;
      opacity: 0;
      transform-origin: center;
    }
    .speed-line.active-right {
      animation: speedLineRight 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    .speed-line.active-left {
      animation: speedLineLeft 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }
    @keyframes speedLineRight {
      0% { opacity: 0.7; width: 0; }
      30% { opacity: 0.9; width: 40vw; }
      100% { opacity: 0; width: 60vw; transform: translateX(20vw); }
    }
    @keyframes speedLineLeft {
      0% { opacity: 0.7; width: 0; }
      30% { opacity: 0.9; width: 40vw; }
      100% { opacity: 0; width: 60vw; transform: translateX(-20vw); }
    }

    /* === PULSE RING en el slide actual === */
    .slide-pulse-border {
      animation: slidePulseBorder 3s ease-in-out infinite;
    }
    @keyframes slidePulseBorder {
      0%, 100% { box-shadow: inset 0 0 0 1px rgba(96,165,250,0.05), 0 0 30px rgba(96,165,250,0); }
      50% { box-shadow: inset 0 0 0 1px rgba(96,165,250,0.15), 0 0 60px rgba(96,165,250,0.05); }
    }

    /* Hover mas dinamico en glass-card */
    .glass-card {
      transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
    }
    .glass-card:hover {
      border-color: rgba(96,165,250,0.25);
      box-shadow: 0 0 40px rgba(96,165,250,0.08), var(--shadow);
    }

    /* Efecto glow en pills al entrar */
    .pill {
      transition: transform .3s ease, background .3s ease, box-shadow .3s ease;
    }
    .pill:hover {
      transform: translateY(-3px);
      background: rgba(96,165,250,.15);
      box-shadow: 0 0 20px rgba(96,165,250,0.15);
    }

    /* Efecto typewriter en el titulo del header */
    .header-glow {
      text-shadow: 0 0 10px rgba(96,165,250,0.4);
    }

    /* Audio button */
    .audio-btn {
      width: 36px; height: 36px;
      border-radius: 10px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.14);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.25s ease;
      position: relative;
    }
    .audio-btn:hover {
      background: rgba(255,255,255,.16);
      border-color: rgba(255,255,255,.25);
      box-shadow: 0 0 15px rgba(96,165,250,0.2);
    }
    .audio-btn .bars {
      display: flex;
      align-items: flex-end;
      gap: 2px;
      height: 14px;
    }
    .audio-btn .bar {
      width: 3px;
      background: rgba(255,255,255,.7);
      border-radius: 1px;
      transition: height 0.3s ease;
    }
    .audio-btn.playing .bar {
      animation: audioBar 0.8s ease-in-out infinite alternate;
    }
    .audio-btn.playing .bar:nth-child(1) { animation-delay: 0s; }
    .audio-btn.playing .bar:nth-child(2) { animation-delay: 0.15s; }
    .audio-btn.playing .bar:nth-child(3) { animation-delay: 0.3s; }
    .audio-btn.playing .bar:nth-child(4) { animation-delay: 0.1s; }
    .audio-btn:not(.playing) .bar { height: 4px !important; opacity: 0.4; }
    @keyframes audioBar {
      0% { height: 4px; }
      100% { height: 14px; }
    }

    /* Slide number indicator con estilo futurista */
    .slide-indicator {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 48;
      display: flex;
      gap: 6px;
      padding: 8px 14px;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(16px);
      border-radius: 20px;
      border: 1px solid rgba(96,165,250,.12);
    }
    .slide-dot {
      width: 8px; height: 8px;
      border-radius: 50%;
      background: rgba(255,255,255,.15);
      transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
      cursor: pointer;
    }
    .slide-dot.active {
      background: var(--accent);
      box-shadow: 0 0 12px rgba(96,165,250,0.8), 0 0 24px rgba(96,165,250,0.3);
      transform: scale(1.5);
      width: 20px;
      border-radius: 4px;
    }
    .slide-dot:hover:not(.active) {
      background: rgba(255,255,255,.4);
      transform: scale(1.2);
    }

    /* === CURSOR TRAIL === */
    .cursor-trail {
      position: fixed;
      width: 8px; height: 8px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 9999;
      background: radial-gradient(circle, rgba(96,165,250,0.6), transparent);
      mix-blend-mode: screen;
      transition: opacity 0.3s ease;
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
    }
  </style>
</head>

<body class="min-h-screen text-white overflow-x-hidden">
  <div class="stars" id="stars"></div>
  <div class="scanlines"></div>
  <div id="particles-container"></div>
  <div class="slide-transition-overlay" id="slide-transition"></div>
  <div class="glitch-overlay" id="glitch-overlay"></div>
  <div class="grid-overlay" id="grid-overlay"></div>
  <div class="energy-ring" id="energy-ring"></div>
  <div id="speed-lines-container"></div>
  <div id="burst-container"></div>
  <div id="cursor-trail-container"></div>

  <!-- Nebulas -->
  <div class="nebula" style="top: 10%; left: -5%; background: radial-gradient(circle, rgba(96,165,250,0.5), transparent 55%);"></div>
  <div class="nebula" style="bottom: 5%; right: -8%; background: radial-gradient(circle, rgba(167,139,250,0.45), transparent 55%); animation-delay: -10s;"></div>
  <div class="nebula" style="top: 50%; left: 50%; background: radial-gradient(circle, rgba(236,72,153,0.25), transparent 60%); animation-delay: -5s; width: 300px; height: 300px;"></div>

  <!-- Header fijo tipo app -->
  <header class="fixed top-0 left-0 right-0 z-50 px-4 py-3">
    <div class="max-w-6xl mx-auto glass-card rounded-2xl px-5 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-xl bg-white/10 flex items-center justify-center text-2xl">&#x1FA90;</div>
        <div>
          <div class="font-bold leading-none">Defensa - Zython</div>
          <div id="header-subtitle" class="text-xs text-white/70">Diapositiva 1 - Portada</div>
        </div>
      </div>

      <div class="hidden md:flex items-center gap-3 w-[360px]">
        <div class="text-xs text-white/70">Progreso</div>
        <div class="flex-1 h-2 rounded-full bg-white/10 overflow-hidden">
          <div id="progress-bar" class="h-full bg-gradient-to-r from-cyan-400 to-purple-500 w-[0%] transition-all duration-500 ease-out"></div>
        </div>
        <div id="progress-text" class="text-xs text-white/70 w-12 text-right">0%</div>
      </div>

      <div class="flex items-center gap-2">
        <button id="audio-toggle" class="audio-btn" title="Sonido ambiental">
          <div class="bars">
            <div class="bar" style="height:6px"></div>
            <div class="bar" style="height:10px"></div>
            <div class="bar" style="height:4px"></div>
            <div class="bar" style="height:8px"></div>
          </div>
        </button>
        <button onclick="prevStep()"
          class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/20 transition font-bold btn-premium"
          title="Anterior">
          &#8592;
        </button>
        <button onclick="nextStep()"
          class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/20 transition font-bold btn-premium"
          title="Siguiente">
          &#8594;
        </button>
      </div>
    </div>
  </header>

  <!-- Slide dots indicator -->
  <div class="slide-indicator" id="slide-indicator"></div>

  <div class="relative z-10 min-h-screen flex flex-col">

    <!-- =========================
         STEP 1 / 15 - PORTADA
    ========================== -->
    <section id="step-1" class="step-container min-h-screen flex items-center justify-center p-6">
      <div class="max-w-6xl w-full text-center animate-fade-in-scale">
        <div class="text-8xl mb-8 animate-float">&#x1F680;</div>

        <h1 class="text-5xl md:text-7xl font-extrabold mb-5 bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent title-hero leading-tight">
          Exploradores del Espacio<br/>Misiones con Robots
        </h1>

        <div class="glass-card p-6 md:p-8 rounded-3xl max-w-4xl mx-auto">
          <div class="text-white/90 text-lg md:text-xl leading-relaxed">
            <div class="font-bold text-white/95">Trabajo Fin de Master</div>
            <div class="mt-2 text-white/80">Master Universitario en Tecnologia Educativa y Competencias Digitales</div>

            <div class="mt-6 grid md:grid-cols-2 gap-4 text-left">
              <div class="glass-card rounded-2xl p-5">
                <div class="text-white/70 text-sm">Autora</div>
                <div class="font-bold text-xl">Maileen Julissa Hoyos Castellanos</div>
                <div class="text-white/70 text-sm mt-2">Especialidad</div>
                <div class="font-bold">Proyecto de Innovacion</div>
              </div>
              <div class="glass-card rounded-2xl p-5">
                <div class="text-white/70 text-sm">Direccion</div>
                <div class="font-bold text-xl">Albert Valls Pou</div>
                <div class="text-white/70 text-sm mt-2">Fecha</div>
                <div class="font-bold">05/02/2026</div>
              </div>
            </div>
          </div>

          <div class="mt-8 flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F9E0; Pensamiento computacional</span>
            <span class="pill">&#x1F4D0; Pensamiento matematico</span>
            <span class="pill">&#x1F916; Robotica educativa</span>
            <span class="pill">&#x1F3AE; Entorno gamificado</span>
          </div>

          <div class="mt-8">
            <button onclick="nextStep()"
              class="px-12 py-5 bg-gradient-to-r from-green-500 via-blue-500 to-purple-600 hover:from-green-600 hover:via-blue-600 hover:to-purple-700 rounded-2xl font-bold text-2xl transition-all duration-300 transform hover:scale-105 btn-3d btn-premium animate-pulse-glow">
              Iniciar defensa &#10024;
            </button>
          </div>
        </div>

        <div class="mt-6 step-counter">Diapositiva <span id="slide-n-1">1</span> / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 2 / 15 - PROBLEMA
    ========================== -->
    <section id="step-2" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F9E9;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Problema educativo
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-3xl mx-auto">
            Como potenciar el pensamiento matematico y computacional en 4 de Primaria con experiencias activas y significativas?
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-3 gap-6">
            <div class="glass-card rounded-2xl p-6">
              <div class="text-3xl mb-2">&#x1F4C9;</div>
              <div class="font-extrabold text-xl text-red-200">Dificultades</div>
              <div class="text-white/80 mt-2">
                Obstaculos en comprension, procedimientos, razonamiento y conexion con contexto.
              </div>
            </div>
            <div class="glass-card rounded-2xl p-6">
              <div class="text-3xl mb-2">&#x1F9E0;</div>
              <div class="font-extrabold text-xl text-yellow-200">Necesidad</div>
              <div class="text-white/80 mt-2">
                Introducir pensamiento computacional como enfoque para resolver problemas: planificar, probar y depurar.
              </div>
            </div>
            <div class="glass-card rounded-2xl p-6">
              <div class="text-3xl mb-2">&#x1F9F2;</div>
              <div class="font-extrabold text-xl text-green-200">Oportunidad</div>
              <div class="text-white/80 mt-2">
                Robotica educativa como puente concreto-abstracto, con retroalimentacion inmediata.
              </div>
            </div>
          </div>

          <div class="mt-8 flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F501; Probar-ajustar</span>
            <span class="pill">&#x1F9EA; Experiencia tangible</span>
            <span class="pill">&#x1F9E0; Metacognicion</span>
            <span class="pill">&#x1F91D; Colaboracion</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 2 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 3 / 15 - PROPUESTA
    ========================== -->
    <section id="step-3" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1FA90;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Propuesta de innovacion
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            Unidad didactica para 4 de Primaria que integra robotica educativa con LEGO Education WeDo 2.0 (o kits similares) y un entorno web gamificado.
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-3xl mb-2">&#x1F916;</div>
              <div class="font-extrabold text-2xl text-cyan-200">Robotica + Bloques</div>
              <div class="text-white/85 mt-3 leading-relaxed">
                Construccion y programacion con retroalimentacion inmediata para activar
                secuenciacion, condicionales, bucles y depuracion.
              </div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-3xl mb-2">&#x1F3AE;</div>
              <div class="font-extrabold text-2xl text-purple-200">Entorno gamificado</div>
              <div class="text-white/85 mt-3 leading-relaxed">
                Misiones autenticas con narrativa espacial, progresion y evidencias en portafolio.
              </div>
            </div>
          </div>

          <div class="mt-7 flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F9E0; PC + PM</span>
            <span class="pill">&#x1F9EA; Resolver problemas</span>
            <span class="pill">&#x1F91D; Trabajo colaborativo</span>
            <span class="pill">&#x1F4C1; Evidencias</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 3 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 4 / 15 - OBJETIVO GENERAL
    ========================== -->
    <section id="step-4" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F3AF;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Objetivo general
          </h2>
        </div>

        <div class="glass-card p-8 md:p-12 rounded-3xl text-center">
          <div class="text-2xl md:text-4xl font-extrabold leading-snug text-white/95">
            Disenar un proyecto de innovacion tecnologica para promover el pensamiento matematico y computacional en 4. de Primaria,
            mediante una unidad didactica con robotica educativa centrada en gamificacion.
          </div>

          <div class="mt-10 flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F4D0; Matematicas</span>
            <span class="pill">&#x1F9E0; Computacional</span>
            <span class="pill">&#x1F916; Robotica</span>
            <span class="pill">&#x1F3AE; Gamificacion</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 4 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 5 / 15 - OBJETIVOS ESPECIFICOS
    ========================== -->
    <section id="step-5" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F9ED;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Objetivos especificos
          </h2>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-3 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-3">&#x1F4BB;</div>
              <div class="font-extrabold text-xl text-cyan-200">Entorno gamificado</div>
              <div class="text-white/85 mt-2">Disenar y programar el recurso en GitHub Pages.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-3">&#x1F9E9;</div>
              <div class="font-extrabold text-xl text-purple-200">Sesiones integradas</div>
              <div class="text-white/85 mt-2">Crear 4-6 sesiones que integren PC + Matematicas.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-3">&#x1F91D;</div>
              <div class="font-extrabold text-xl text-green-200">Cooperacion</div>
              <div class="text-white/85 mt-2">Fomentar trabajo cooperativo en equipos pequenos.</div>
            </div>
          </div>

          <div class="mt-8 flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F4C1; Portafolio</span>
            <span class="pill">&#x1F9EA; Ciclo iterativo</span>
            <span class="pill">&#x1F9E0; Evidencias</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 5 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 6 / 15 - FUNDAMENTOS
    ========================== -->
    <section id="step-6" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F4DA;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Fundamentos del proyecto
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            El diseno integra pensamiento computacional, pensamiento matematico, trabajo colaborativo y robotica educativa.
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-4 gap-5">
            <div class="glass-card rounded-2xl p-6">
              <div class="text-4xl">&#x1F9E0;</div>
              <div class="font-extrabold mt-2 text-cyan-200">PC</div>
              <div class="text-white/80 mt-2 text-sm">Descomposicion - patrones - abstraccion - algoritmos - razonamiento</div>
            </div>
            <div class="glass-card rounded-2xl p-6">
              <div class="text-4xl">&#x1F4D0;</div>
              <div class="font-extrabold mt-2 text-purple-200">PM</div>
              <div class="text-white/80 mt-2 text-sm">Numero - medida - geometria - datos - variacional</div>
            </div>
            <div class="glass-card rounded-2xl p-6">
              <div class="text-4xl">&#x1F91D;</div>
              <div class="font-extrabold mt-2 text-green-200">Colaboracion</div>
              <div class="text-white/80 mt-2 text-sm">Roles - coautoria - coordinacion - comunicacion</div>
            </div>
            <div class="glass-card rounded-2xl p-6">
              <div class="text-4xl">&#x1F916;</div>
              <div class="font-extrabold mt-2 text-yellow-200">Robotica</div>
              <div class="text-white/80 mt-2 text-sm">Concreto-simbolico - medir - probar - ajustar</div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <span class="pill">&#x1F501; Construir</span>
            <span class="pill">&#x1F9E9; Programar</span>
            <span class="pill">&#x1F9EA; Probar</span>
            <span class="pill">&#x1F527; Mejorar</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 6 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 7 / 15 - CONTEXTO
    ========================== -->
    <section id="step-7" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F4CD;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Contexto de implementacion
          </h2>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F3D9;&#xFE0F;</div>
              <div class="font-extrabold text-xl text-cyan-200">Bucaramanga (Colombia)</div>
              <div class="text-white/85 mt-2">
                Entorno urbano, diversidad socioeconomica y oportunidad para reducir brechas en habilidades digitales.
              </div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F3EB;</div>
              <div class="font-extrabold text-xl text-purple-200">Microcentro de aprendizaje</div>
              <div class="text-white/85 mt-2">
                Grupos reducidos (6-8), conectividad, dispositivos y kits de robotica.
              </div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <span class="pill">&#x1F9EA; STEAM</span>
            <span class="pill">&#x1FA91; Mobiliario flexible</span>
            <span class="pill">&#x1F4F6; Conectividad</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 7 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 8 / 15 - DESTINATARIOS + INCLUSION
    ========================== -->
    <section id="step-8" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F467;&#x1F466;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Destinatarios e inclusion
          </h2>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-3 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F9D2;</div>
              <div class="font-extrabold text-xl text-cyan-200">8-10 anos</div>
              <div class="text-white/85 mt-2">Ninos y ninas de 3 y 4 de primaria.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F3B2;</div>
              <div class="font-extrabold text-xl text-purple-200">Aprender con retos</div>
              <div class="text-white/85 mt-2">Narrativa, manipulacion, experimentacion y trabajo en equipo.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x267F;</div>
              <div class="font-extrabold text-xl text-green-200">NEAE</div>
              <div class="text-white/85 mt-2">Consignas visuales, roles flexibles, tiempos extendidos y andamiaje paso a paso.</div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <span class="pill">&#x1F9E9; Segmentacion</span>
            <span class="pill">&#x1F9E0; Autorregulacion</span>
            <span class="pill">&#x1F9F0; Material manipulativo</span>
            <span class="pill">&#x1F4CC; Guias pictograficas</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 8 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 9 / 15 - METODOLOGIA (CICLO)
    ========================== -->
    <section id="step-9" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F501;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Metodologia
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            Misiones autenticas con un ciclo iterativo para construir soluciones, validarlas y mejorarlas.
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-4 gap-5">
            <div class="glass-card rounded-2xl p-7 text-center">
              <div class="text-5xl">&#x1F9F1;</div>
              <div class="font-extrabold text-xl mt-2 text-yellow-200">Construir</div>
              <div class="text-white/80 mt-2 text-sm">Prototipo RoverBot</div>
            </div>
            <div class="glass-card rounded-2xl p-7 text-center">
              <div class="text-5xl">&#x1F9E9;</div>
              <div class="font-extrabold text-xl mt-2 text-cyan-200">Programar</div>
              <div class="text-white/80 mt-2 text-sm">Bloques, secuencias, control</div>
            </div>
            <div class="glass-card rounded-2xl p-7 text-center">
              <div class="text-5xl">&#x1F9EA;</div>
              <div class="font-extrabold text-xl mt-2 text-purple-200">Probar</div>
              <div class="text-white/80 mt-2 text-sm">Medir, registrar, observar</div>
            </div>
            <div class="glass-card rounded-2xl p-7 text-center">
              <div class="text-5xl">&#x1F527;</div>
              <div class="font-extrabold text-xl mt-2 text-green-200">Mejorar</div>
              <div class="text-white/80 mt-2 text-sm">Ajustes y depuracion</div>
            </div>
          </div>

          <div class="mt-8 flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F91D; Equipos 2-3</span>
            <span class="pill">&#x1F9ED; Roles</span>
            <span class="pill">&#x1F4C1; Portafolio</span>
            <span class="pill">&#x1F9E0; Reflexion</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 9 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 10 / 15 - SECUENCIA DE MISIONES
    ========================== -->
    <section id="step-10" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F9ED;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Secuencia de misiones
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            Progresion desde ensamblaje y calibracion hasta retos con control, sensor y colaboracion.
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F30C;</div>
              <div class="font-extrabold text-2xl text-cyan-200">Narrativa espacial</div>
              <div class="text-white/85 mt-2">
                Misiones contextualizadas que mantienen motivacion y sentido de proposito.
              </div>
              <div class="mt-5 flex flex-wrap gap-2">
                <span class="pill">&#x1F3AE; Gamificacion</span>
                <span class="pill">&#x1F3C5; Insignias</span>
                <span class="pill">&#x1F513; Desbloqueo</span>
              </div>
            </div>

            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F4C8;</div>
              <div class="font-extrabold text-2xl text-purple-200">Complejidad creciente</div>
              <div class="text-white/85 mt-2">
                Del control de variables (distancia/tiempo) a condicionales, bucles, sensor y tareas de equipo.
              </div>
              <div class="mt-5 flex flex-wrap gap-2">
                <span class="pill">&#x1F4CF; Medicion</span>
                <span class="pill">&#x1F4CA; Registro</span>
                <span class="pill">&#x1F9E0; Depuracion</span>
              </div>
            </div>
          </div>

          <div class="mt-8 grid md:grid-cols-4 gap-4 text-center">
            <div class="glass-card rounded-2xl p-6 hover:scale-[1.02] transition">
              <div class="text-5xl mb-2">&#x1F6E0;&#xFE0F;</div>
              <div class="font-extrabold text-yellow-200">Mision 0</div>
              <div class="text-white/80 text-sm mt-1">Ensamblaje + conexion</div>
            </div>
            <div class="glass-card rounded-2xl p-6 hover:scale-[1.02] transition">
              <div class="text-5xl mb-2">&#x1F3D4;&#xFE0F;</div>
              <div class="font-extrabold text-orange-200">Mision 1</div>
              <div class="text-white/80 text-sm mt-1">Calibracion / pruebas</div>
            </div>
            <div class="glass-card rounded-2xl p-6 hover:scale-[1.02] transition">
              <div class="text-5xl mb-2">&#x1F300;</div>
              <div class="font-extrabold text-blue-200">Mision 2</div>
              <div class="text-white/80 text-sm mt-1">Conexion / avance guiado</div>
            </div>
            <div class="glass-card rounded-2xl p-6 hover:scale-[1.02] transition">
              <div class="text-5xl mb-2">&#x1F573;&#xFE0F;</div>
              <div class="font-extrabold text-fuchsia-200">Mision 3</div>
              <div class="text-white/80 text-sm mt-1">Sensor / condicion</div>
            </div>
          </div>

          <div class="mt-4 grid md:grid-cols-1 gap-4 text-center">
            <div class="glass-card rounded-2xl p-6 hover:scale-[1.01] transition">
              <div class="text-5xl mb-2">&#x1F69B;</div>
              <div class="font-extrabold text-green-200">Mision 4</div>
              <div class="text-white/80 text-sm mt-1">Transferencia / colaboracion</div>
            </div>
          </div>

        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 10 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 11 / 15 - PRODUCTO (6 TARJETAS + MODAL IFRAME)
    ========================== -->
    <section id="step-11" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-8">
          <div class="text-7xl mb-4 animate-float">&#x1F9EA;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Producto tecnopedagogico (recurso digital)
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            Se muestra el entorno gamificado: selecciona una tarjeta para abrir la seccion correspondiente (se ejecuta en una pantalla superpuesta).
          </p>
        </div>

        <div class="grid md:grid-cols-3 gap-6">

          <button class="float-card p-6 text-left" onclick="openProductModal('Tarjeta 1 - Mision 0 (Ensamblaje)', 'https://maihoyos.github.io/exploradores/mision0.html')">
            <div class="float-orb one"></div><div class="float-orb two"></div>
            <div class="tag text-cyan-200">Tarjeta 1 - mision0.html</div>
            <div class="mt-4 text-2xl font-extrabold">&#x1F6E0;&#xFE0F; Ensamblaje</div>
            <div class="mt-2 text-white/80">Inicio + instrucciones + conexion.</div>
          </button>

          <button class="float-card p-6 text-left" onclick="openProductModal('Tarjeta 2 - Indice (Panel de misiones)', 'https://maihoyos.github.io/exploradores/index.html')">
            <div class="float-orb one"></div><div class="float-orb two"></div>
            <div class="tag text-purple-200">Tarjeta 2 - index.html</div>
            <div class="mt-4 text-2xl font-extrabold">&#x1F9ED; Panel</div>
            <div class="mt-2 text-white/80">Navegacion + progreso de misiones.</div>
          </button>

          <button class="float-card p-6 text-left" onclick="openProductModal('Tarjeta 3 - Mision 1', 'https://maihoyos.github.io/exploradores/mision1.html?reset=1770309136702')">
            <div class="float-orb one"></div><div class="float-orb two"></div>
            <div class="tag text-emerald-200">Tarjeta 3 - mision1</div>
            <div class="mt-4 text-2xl font-extrabold">&#x1F3D4;&#xFE0F; Vectonia</div>
            <div class="mt-2 text-white/80">Calibracion y primeros retos.</div>
          </button>

          <button class="float-card p-6 text-left" onclick="openProductModal('Tarjeta 4 - Mision 2', 'https://maihoyos.github.io/exploradores/mision2.html?reset=1770309173677')">
            <div class="float-orb one"></div><div class="float-orb two"></div>
            <div class="tag text-blue-200">Tarjeta 4 - mision2</div>
            <div class="mt-4 text-2xl font-extrabold">&#x1F300; Zycurva</div>
            <div class="mt-2 text-white/80">Avance guiado por retos.</div>
          </button>

          <button class="float-card p-6 text-left" onclick="openProductModal('Tarjeta 5 - Mision 3', 'https://maihoyos.github.io/exploradores/mision3.html?reset=1770309206648')">
            <div class="float-orb one"></div><div class="float-orb two"></div>
            <div class="tag text-fuchsia-200">Tarjeta 5 - mision3</div>
            <div class="mt-4 text-2xl font-extrabold">&#x1F573;&#xFE0F; Sensorium</div>
            <div class="mt-2 text-white/80">Condicion + control con sensor.</div>
          </button>

          <button class="float-card p-6 text-left" onclick="openProductModal('Tarjeta 6 - Mision 4', 'https://maihoyos.github.io/exploradores/mision4.html?reset=1770309233412')">
            <div class="float-orb one"></div><div class="float-orb two"></div>
            <div class="tag text-yellow-200">Tarjeta 6 - mision4</div>
            <div class="mt-4 text-2xl font-extrabold">&#x1F69B; Transferencia</div>
            <div class="mt-2 text-white/80">Mision integradora colaborativa.</div>
          </button>
        </div>

        <div class="mt-8 text-center">
          <div class="flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F3AE; Gamificacion</span>
            <span class="pill">&#x1F3C5; Insignias</span>
            <span class="pill">&#x1F9E9; Andamiaje</span>
            <span class="pill">&#x1F4C1; Evidencias</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 11 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 12 / 15 - PRUEBA PILOTO
    ========================== -->
    <section id="step-12" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F9EA;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Prueba piloto y ajustes
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            Pilotaje exploratorio del entorno gamificado para analizar claridad, coherencia y funcionalidad; ajustes derivados antes de una implementacion a mayor escala.
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-3 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F50D;</div>
              <div class="font-extrabold text-xl text-cyan-200">Que se analizo</div>
              <div class="text-white/85 mt-2">Claridad, coherencia y funcionalidad del recurso.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F9ED;</div>
              <div class="font-extrabold text-xl text-purple-200">Como se uso</div>
              <div class="text-white/85 mt-2">Recorrido de misiones, andamiajes y navegacion.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F527;</div>
              <div class="font-extrabold text-xl text-green-200">Que se ajusto</div>
              <div class="text-white/85 mt-2">Mejoras para facilitar comprension y usabilidad.</div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <span class="pill">&#x2705; Listo para implementacion futura</span>
            <span class="pill">&#x267B;&#xFE0F; Iteracion y mejora</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 12 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 13 / 15 - EVALUACION (APRENDIZAJE)
    ========================== -->
    <section id="step-13" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F4CA;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Evaluacion del aprendizaje
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            Evaluacion formativa con evidencias de proceso y producto (portafolio).
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F4CB;</div>
              <div class="font-extrabold text-2xl text-cyan-200">Formativa</div>
              <div class="text-white/85 mt-2">
                Seguimiento durante las misiones: observacion, retroalimentacion y mejora.
              </div>
              <div class="mt-4 flex flex-wrap gap-2">
                <span class="pill">&#x1F9E0; Depuracion</span>
                <span class="pill">&#x1F4CF; Medicion</span>
                <span class="pill">&#x1F9FE; Registro</span>
              </div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F4C1;</div>
              <div class="font-extrabold text-2xl text-purple-200">Portafolio</div>
              <div class="text-white/85 mt-2">
                Artefactos: codigo, prototipos, tablas/graficas, capturas y narrativas reflexivas.
              </div>
              <div class="mt-4 flex flex-wrap gap-2">
                <span class="pill">&#x1F9E9; Codigo</span>
                <span class="pill">&#x1F4CA; Datos</span>
                <span class="pill">&#x270D;&#xFE0F; Reflexion</span>
              </div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <span class="pill">&#x1F3AF; Criterios explicitos</span>
            <span class="pill">&#x1F9E0; Metacognicion</span>
            <span class="pill">&#x1F91D; Evidencias de coautoria</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 13 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 14 / 15 - CONCLUSIONES
    ========================== -->
    <section id="step-14" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x2705;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Conclusiones
          </h2>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-2 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F916;</div>
              <div class="font-extrabold text-2xl text-cyan-200">Aporte didactico</div>
              <div class="text-white/85 mt-2">
                Propuesta transferible y escalable que integra robotica y gamificacion para potenciar PC y PM en primaria.
              </div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F9E0;</div>
              <div class="font-extrabold text-2xl text-purple-200">Aprendizajes</div>
              <div class="text-white/85 mt-2">
                Fortalece resolucion de problemas, colaboracion, registro de evidencias y ciclos de mejora.
              </div>
            </div>
          </div>

          <div class="mt-8 flex justify-center gap-3 flex-wrap">
            <span class="pill">&#x1F4D0; Curriculo</span>
            <span class="pill">&#x1F9E9; Programacion por bloques</span>
            <span class="pill">&#x1F9EA; Ciclo iterativo</span>
            <span class="pill">&#x1F3AE; Motivacion</span>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="nextStep()" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">Siguiente &#8594;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 14 / 15</div>
      </div>
    </section>

    <!-- =========================
         STEP 15 / 15 - LIMITACIONES + PROSPECTIVA
    ========================== -->
    <section id="step-15" class="step-container min-h-screen hidden items-center justify-center p-6">
      <div class="max-w-6xl w-full">
        <div class="text-center mb-6">
          <div class="text-7xl mb-3 animate-float">&#x1F52D;</div>
          <h2 class="text-4xl md:text-6xl font-extrabold bg-gradient-to-r from-cyan-300 via-blue-400 to-purple-500 bg-clip-text text-transparent text-glow">
            Limitaciones y prospectiva
          </h2>
          <p class="mt-3 text-white/80 text-lg max-w-4xl mx-auto">
            Cierre con mirada de futuro: implementacion ampliada y evaluacion en contexto escolar formal.
          </p>
        </div>

        <div class="glass-card p-7 md:p-10 rounded-3xl">
          <div class="grid md:grid-cols-3 gap-6">
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x23F3;</div>
              <div class="font-extrabold text-xl text-yellow-200">Limitacion</div>
              <div class="text-white/85 mt-2">Pilotaje exploratorio y necesidad de implementacion a mayor escala.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F3EB;</div>
              <div class="font-extrabold text-xl text-cyan-200">Futuro 1</div>
              <div class="text-white/85 mt-2">Aplicacion en aula formal con grupos completos y continuidad.</div>
            </div>
            <div class="glass-card rounded-2xl p-7">
              <div class="text-4xl mb-2">&#x1F4C8;</div>
              <div class="font-extrabold text-xl text-purple-200">Futuro 2</div>
              <div class="text-white/85 mt-2">Evaluacion longitudinal: progreso en PC, PM y colaboracion.</div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <div class="glass-card rounded-2xl p-6 inline-block">
              <div class="text-2xl font-extrabold text-green-200">&#10024; Gracias</div>
              <div class="text-white/80 mt-1">Quedo atenta a sus preguntas.</div>
            </div>
          </div>

          <div class="mt-8 flex justify-center gap-3 flex-wrap">
            <button onclick="goToStep(1)"
              class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">
              &#8634; Volver al inicio
            </button>
            <button onclick="goToStep(11)"
              class="px-8 py-4 bg-blue-600 hover:bg-blue-700 rounded-2xl font-bold btn-3d btn-premium">
              &#x1F9EA; Volver al producto
            </button>
          </div>
        </div>

        <div class="mt-6 flex justify-between">
          <button onclick="prevStep()" class="px-8 py-4 bg-white/10 hover:bg-white/20 rounded-2xl font-bold btn-3d btn-premium">&#8592; Anterior</button>
          <button onclick="goToStep(1)" class="px-8 py-4 bg-green-600 hover:bg-green-700 rounded-2xl font-bold btn-3d btn-premium">Finalizar &#10004;</button>
        </div>

        <div class="mt-4 step-counter text-center">Diapositiva 15 / 15</div>
      </div>
    </section>

  </div>

  <!-- Modal Producto (iframe) -->
  <div id="product-modal" aria-hidden="true">
    <div id="product-modal-backdrop"></div>

    <div class="product-modal-panel">
      <div class="product-modal-topbar">
        <div class="product-modal-title" id="product-modal-title">Producto</div>

        <div class="product-modal-actions">
          <a id="product-modal-opennew"
             class="product-modal-btn btn-premium"
             href="#"
             target="_blank"
             rel="noopener noreferrer"
             title="Abrir en una pestana nueva">
            &#8599; Abrir
          </a>

          <button id="product-modal-close" class="product-modal-btn btn-premium" aria-label="Cerrar (ESC)">
            &#10005;
          </button>
        </div>
      </div>

      <iframe id="product-modal-iframe" class="product-iframe" title="Producto Zython" loading="lazy"></iframe>
    </div>
  </div>

  <script>
    'use strict';

    // ====== ESTRELLAS (mas densas) ======
    function createStars() {
      var starsContainer = document.getElementById('stars');
      if (!starsContainer) return;
      starsContainer.innerHTML = '';
      for (var i = 0; i < 220; i++) {
        var star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        var size = Math.random() * 3.5 + 0.5;
        star.style.width = size + 'px';
        star.style.height = size + 'px';
        star.style.animationDelay = Math.random() * 4 + 's';
        star.style.animationDuration = (Math.random() * 3 + 2) + 's';
        starsContainer.appendChild(star);
      }
    }

    // Parallax agresivo con mouse
    var mouseX = 0, mouseY = 0;
    document.addEventListener('mousemove', function(e) {
      mouseX = (e.clientX / window.innerWidth - 0.5);
      mouseY = (e.clientY / window.innerHeight - 0.5);
      var stars = document.getElementById('stars');
      if (stars) stars.style.transform = 'translate(' + (mouseX * 25) + 'px, ' + (mouseY * 25) + 'px)';
      // Nebulas parallax opuesto
      var nebulas = document.querySelectorAll('.nebula');
      nebulas.forEach(function(n, idx) {
        var factor = (idx + 1) * 15;
        n.style.transform = 'translate(' + (-mouseX * factor) + 'px, ' + (-mouseY * factor) + 'px)';
      });
    });

    // ====== CURSOR TRAIL ======
    var trailDots = [];
    var TRAIL_COUNT = 8;
    function createCursorTrail() {
      var container = document.getElementById('cursor-trail-container');
      if (!container) return;
      for (var i = 0; i < TRAIL_COUNT; i++) {
        var dot = document.createElement('div');
        dot.className = 'cursor-trail';
        dot.style.opacity = '0';
        dot.style.width = (8 - i) + 'px';
        dot.style.height = (8 - i) + 'px';
        container.appendChild(dot);
        trailDots.push({ el: dot, x: 0, y: 0 });
      }
    }
    var trailMouseX = 0, trailMouseY = 0;
    document.addEventListener('mousemove', function(e) {
      trailMouseX = e.clientX;
      trailMouseY = e.clientY;
    });
    function animateTrail() {
      var prevX = trailMouseX, prevY = trailMouseY;
      for (var i = 0; i < trailDots.length; i++) {
        var dot = trailDots[i];
        dot.x += (prevX - dot.x) * 0.35;
        dot.y += (prevY - dot.y) * 0.35;
        dot.el.style.left = dot.x + 'px';
        dot.el.style.top = dot.y + 'px';
        dot.el.style.opacity = (1 - i / trailDots.length) * 0.4;
        prevX = dot.x;
        prevY = dot.y;
      }
      requestAnimationFrame(animateTrail);
    }

    // ====== PARTICULAS FLOTANTES (mas visibles) ======
    function createParticles() {
      var container = document.getElementById('particles-container');
      if (!container) return;
      for (var i = 0; i < 40; i++) {
        var p = document.createElement('div');
        p.className = 'particle';
        var size = Math.random() * 4 + 1.5;
        p.style.width = size + 'px';
        p.style.height = size + 'px';
        p.style.left = Math.random() * 100 + '%';
        var colors = [
          'rgba(96,165,250,' + (Math.random() * 0.5 + 0.3) + ')',
          'rgba(167,139,250,' + (Math.random() * 0.5 + 0.3) + ')',
          'rgba(236,72,153,' + (Math.random() * 0.3 + 0.15) + ')'
        ];
        p.style.background = colors[Math.floor(Math.random() * colors.length)];
        p.style.boxShadow = '0 0 ' + (size * 3) + 'px ' + p.style.background;
        p.style.animationDuration = (Math.random() * 10 + 6) + 's';
        p.style.animationDelay = (Math.random() * 8) + 's';
        container.appendChild(p);
      }
    }

    // ====== ESTRELLAS FUGACES (mas frecuentes) ======
    function spawnShootingStar() {
      var star = document.createElement('div');
      star.className = 'shooting-star';
      star.style.top = Math.random() * 40 + '%';
      star.style.left = Math.random() * 50 + '%';
      document.body.appendChild(star);
      setTimeout(function() { star.remove(); }, 1300);
    }
    setInterval(function() {
      if (Math.random() > 0.4) spawnShootingStar();
    }, 3000);

    // ====== SPEED LINES (lineas de velocidad) ======
    function spawnSpeedLines(direction) {
      var container = document.getElementById('speed-lines-container');
      if (!container) return;
      for (var i = 0; i < 12; i++) {
        var line = document.createElement('div');
        line.className = 'speed-line';
        line.style.top = (Math.random() * 80 + 10) + '%';
        line.style.background = 'linear-gradient(' + (direction === 'right' ? '90deg' : '-90deg') + ', rgba(96,165,250,' + (Math.random() * 0.3 + 0.1) + '), transparent)';
        line.style.height = (Math.random() * 2 + 0.5) + 'px';
        if (direction === 'right') {
          line.style.left = (Math.random() * 30) + '%';
          line.classList.add('active-right');
        } else {
          line.style.right = (Math.random() * 30) + '%';
          line.classList.add('active-left');
        }
        container.appendChild(line);
        (function(el) { setTimeout(function() { el.remove(); }, 700); })(line);
      }
    }

    // ====== BURST PARTICLES (explosion al cambiar) ======
    function spawnBurst() {
      var container = document.getElementById('burst-container');
      if (!container) return;
      var cx = window.innerWidth / 2;
      var cy = window.innerHeight / 2;
      for (var i = 0; i < 20; i++) {
        var p = document.createElement('div');
        p.className = 'burst-particle';
        p.style.left = cx + 'px';
        p.style.top = cy + 'px';
        var angle = (Math.PI * 2 / 20) * i + Math.random() * 0.3;
        var dist = 80 + Math.random() * 200;
        var dx = Math.cos(angle) * dist;
        var dy = Math.sin(angle) * dist;
        p.style.setProperty('--burst-dir', 'translate(' + dx + 'px, ' + dy + 'px)');
        var size = Math.random() * 5 + 2;
        p.style.width = size + 'px';
        p.style.height = size + 'px';
        var colors = ['rgba(96,165,250,0.8)', 'rgba(167,139,250,0.8)', 'rgba(236,72,153,0.6)', 'rgba(255,255,255,0.6)'];
        p.style.background = colors[Math.floor(Math.random() * colors.length)];
        p.style.boxShadow = '0 0 6px ' + p.style.background;
        container.appendChild(p);
        void p.offsetWidth;
        p.classList.add('active');
        (function(el) { setTimeout(function() { el.remove(); }, 900); })(p);
      }
    }

    // ====== SLIDE DOTS INDICATOR ======
    function createSlideIndicator() {
      var indicator = document.getElementById('slide-indicator');
      if (!indicator) return;
      for (var i = 1; i <= TOTAL_STEPS; i++) {
        var dot = document.createElement('div');
        dot.className = 'slide-dot';
        dot.dataset.step = i;
        dot.title = 'Diapositiva ' + i;
        (function(step) {
          dot.addEventListener('click', function() { goToStep(step); });
        })(i);
        indicator.appendChild(dot);
      }
    }

    function updateSlideIndicator() {
      var dots = document.querySelectorAll('.slide-dot');
      dots.forEach(function(dot) {
        var step = parseInt(dot.dataset.step);
        if (step === currentStep) {
          dot.classList.add('active');
        } else {
          dot.classList.remove('active');
        }
      });
    }

    // ====== AUDIO AMBIENTAL (Web Audio API) ======
    var audioCtx = null;
    var ambientNodes = [];
    var isAudioPlaying = false;
    var masterGainNode = null;

    function initAmbientAudio() {
      if (audioCtx) return;
      try {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        masterGainNode = audioCtx.createGain();
        masterGainNode.gain.value = 0.08;
        masterGainNode.connect(audioCtx.destination);

        // Drone harmonico espacial con mas capas
        var layers = [
          { freq: 48, type: 'sine', vol: 0.2 },
          { freq: 55, type: 'sine', vol: 0.18 },
          { freq: 82.5, type: 'sine', vol: 0.12 },
          { freq: 110, type: 'triangle', vol: 0.06 },
          { freq: 165, type: 'sine', vol: 0.04 },
          { freq: 220, type: 'sine', vol: 0.02 }
        ];
        layers.forEach(function(layer) {
          var osc = audioCtx.createOscillator();
          osc.type = layer.type;
          osc.frequency.value = layer.freq;

          var oscGain = audioCtx.createGain();
          oscGain.gain.value = layer.vol;

          // LFO para modulacion
          var lfo = audioCtx.createOscillator();
          lfo.type = 'sine';
          lfo.frequency.value = 0.03 + Math.random() * 0.08;
          var lfoGain = audioCtx.createGain();
          lfoGain.gain.value = layer.freq * 0.008;
          lfo.connect(lfoGain);
          lfoGain.connect(osc.frequency);
          lfo.start();

          // Amplitude LFO para breathing
          var ampLfo = audioCtx.createOscillator();
          ampLfo.type = 'sine';
          ampLfo.frequency.value = 0.02 + Math.random() * 0.05;
          var ampLfoGain = audioCtx.createGain();
          ampLfoGain.gain.value = layer.vol * 0.3;
          ampLfo.connect(ampLfoGain);
          ampLfoGain.connect(oscGain.gain);
          ampLfo.start();

          osc.connect(oscGain);
          oscGain.connect(masterGainNode);
          osc.start();

          ambientNodes.push(osc, lfo, ampLfo, oscGain, lfoGain, ampLfoGain);
        });

        isAudioPlaying = true;
        document.getElementById('audio-toggle').classList.add('playing');
      } catch (e) {}
    }

    function toggleAudio() {
      if (!audioCtx) {
        initAmbientAudio();
        return;
      }
      if (audioCtx.state === 'suspended') {
        audioCtx.resume();
        isAudioPlaying = true;
        document.getElementById('audio-toggle').classList.add('playing');
      } else if (isAudioPlaying) {
        audioCtx.suspend();
        isAudioPlaying = false;
        document.getElementById('audio-toggle').classList.remove('playing');
      } else {
        audioCtx.resume();
        isAudioPlaying = true;
        document.getElementById('audio-toggle').classList.add('playing');
      }
    }

    // Sonido de transicion MEJORADO (whoosh + impact)
    function playTransitionSound(direction) {
      if (!audioCtx || !isAudioPlaying) return;
      try {
        var t = audioCtx.currentTime;

        // Whoosh principal
        var osc1 = audioCtx.createOscillator();
        osc1.type = 'sine';
        if (direction === 'right') {
          osc1.frequency.setValueAtTime(300, t);
          osc1.frequency.exponentialRampToValueAtTime(900, t + 0.15);
          osc1.frequency.exponentialRampToValueAtTime(150, t + 0.4);
        } else {
          osc1.frequency.setValueAtTime(900, t);
          osc1.frequency.exponentialRampToValueAtTime(300, t + 0.15);
          osc1.frequency.exponentialRampToValueAtTime(150, t + 0.4);
        }
        var gain1 = audioCtx.createGain();
        gain1.gain.setValueAtTime(0, t);
        gain1.gain.linearRampToValueAtTime(0.08, t + 0.05);
        gain1.gain.exponentialRampToValueAtTime(0.001, t + 0.45);
        osc1.connect(gain1);
        gain1.connect(audioCtx.destination);
        osc1.start(t);
        osc1.stop(t + 0.5);

        // Ruido de impacto sutil
        var bufferSize = audioCtx.sampleRate * 0.15;
        var buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
        var data = buffer.getChannelData(0);
        for (var i = 0; i < bufferSize; i++) {
          data[i] = (Math.random() * 2 - 1) * Math.exp(-i / (bufferSize * 0.15));
        }
        var noise = audioCtx.createBufferSource();
        noise.buffer = buffer;
        var noiseGain = audioCtx.createGain();
        noiseGain.gain.setValueAtTime(0.04, t + 0.1);
        noiseGain.gain.exponentialRampToValueAtTime(0.001, t + 0.3);
        var filter = audioCtx.createBiquadFilter();
        filter.type = 'lowpass';
        filter.frequency.value = 800;
        noise.connect(filter);
        filter.connect(noiseGain);
        noiseGain.connect(audioCtx.destination);
        noise.start(t + 0.1);

        // Tono cristalino de confirmacion
        var osc2 = audioCtx.createOscillator();
        osc2.type = 'sine';
        osc2.frequency.setValueAtTime(1200, t + 0.15);
        osc2.frequency.exponentialRampToValueAtTime(800, t + 0.5);
        var gain2 = audioCtx.createGain();
        gain2.gain.setValueAtTime(0.03, t + 0.15);
        gain2.gain.exponentialRampToValueAtTime(0.001, t + 0.55);
        osc2.connect(gain2);
        gain2.connect(audioCtx.destination);
        osc2.start(t + 0.15);
        osc2.stop(t + 0.6);
      } catch (e) {}
    }

    document.getElementById('audio-toggle').addEventListener('click', toggleAudio);

    // ====== NAVEGACION STEPS ======
    var TOTAL_STEPS = 15;
    var currentStep = 1;
    var isTransitioning = false;

    var subtitleMap = {
      1: 'Portada',
      2: 'Problema educativo',
      3: 'Propuesta de innovacion',
      4: 'Objetivo general',
      5: 'Objetivos especificos',
      6: 'Fundamentos del proyecto',
      7: 'Contexto de implementacion',
      8: 'Destinatarios e inclusion',
      9: 'Metodologia',
      10: 'Secuencia de misiones',
      11: 'Producto tecnopedagogico',
      12: 'Prueba piloto y ajustes',
      13: 'Evaluacion del aprendizaje',
      14: 'Conclusiones',
      15: 'Limitaciones y prospectiva'
    };

    function triggerAllTransitionEffects(dir) {
      // 1. Warp flash direccional
      var transOverlay = document.getElementById('slide-transition');
      if (transOverlay) {
        transOverlay.classList.remove('active-right', 'active-left');
        void transOverlay.offsetWidth;
        transOverlay.classList.add(dir === 'right' ? 'active-right' : 'active-left');
      }

      // 2. Glitch flash
      var glitchOverlay = document.getElementById('glitch-overlay');
      if (glitchOverlay) {
        glitchOverlay.classList.remove('active');
        void glitchOverlay.offsetWidth;
        glitchOverlay.classList.add('active');
      }

      // 3. Grid flash
      var gridOverlay = document.getElementById('grid-overlay');
      if (gridOverlay) {
        gridOverlay.classList.remove('flash');
        void gridOverlay.offsetWidth;
        gridOverlay.classList.add('flash');
      }

      // 4. Energy ring
      var ring = document.getElementById('energy-ring');
      if (ring) {
        ring.classList.remove('active');
        void ring.offsetWidth;
        ring.classList.add('active');
      }

      // 5. Speed lines
      spawnSpeedLines(dir);

      // 6. Burst particles
      spawnBurst();

      // 7. Sound
      playTransitionSound(dir);

      // 8. Screen shake sutil
      document.body.style.transition = 'none';
      document.body.style.transform = 'translateX(' + (dir === 'right' ? '3' : '-3') + 'px)';
      setTimeout(function() {
        document.body.style.transition = 'transform 0.3s cubic-bezier(0.22, 1, 0.36, 1)';
        document.body.style.transform = 'translateX(0)';
      }, 50);
    }

    function showStep(n, direction) {
      if (isTransitioning) return;
      isTransitioning = true;

      var dir = direction || 'right';
      var prevStep = currentStep;

      // Animar la salida del slide anterior
      var prev = document.getElementById('step-' + prevStep);
      if (prev && prevStep !== n) {
        var prevContent = prev.querySelector('div');
        if (prevContent) {
          prevContent.classList.remove('slide-enter', 'slide-enter-right', 'slide-enter-left', 'slide-exit-right', 'slide-exit-left');
          void prevContent.offsetWidth;
          prevContent.classList.add(dir === 'right' ? 'slide-exit-right' : 'slide-exit-left');
        }
      }

      // Disparar TODOS los efectos de transicion
      triggerAllTransitionEffects(dir);

      // Delay para permitir animacion de salida
      setTimeout(function() {
        // Ocultar todos
        for (var i = 1; i <= TOTAL_STEPS; i++) {
          var el = document.getElementById('step-' + i);
          if (!el) continue;
          el.classList.add('hidden');
          el.classList.remove('flex');
          var c = el.querySelector('div');
          if (c) c.classList.remove('slide-enter', 'slide-enter-right', 'slide-enter-left', 'slide-exit-right', 'slide-exit-left');
        }

        // Mostrar el actual con animacion
        var cur = document.getElementById('step-' + n);
        if (cur) {
          cur.classList.remove('hidden');
          cur.classList.add('flex');

          var content = cur.querySelector('div');
          if (content) {
            void content.offsetWidth;
            if (dir === 'right') {
              content.classList.add('slide-enter-right');
            } else if (dir === 'left') {
              content.classList.add('slide-enter-left');
            } else {
              content.classList.add('slide-enter');
            }
          }

          // Animar las sub-cards con stagger
          var cards = cur.querySelectorAll('.glass-card, .float-card, .pill');
          cards.forEach(function(card, idx) {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(function() {
              card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
              card.style.opacity = '1';
              card.style.transform = 'translateY(0)';
            }, 100 + idx * 60);
          });
        }

        currentStep = n;
        updateProgress();
        updateHeader();
        updateSlideIndicator();
        window.scrollTo({ top: 0, behavior: 'smooth' });

        setTimeout(function() { isTransitioning = false; }, 400);
      }, 250);
    }

    function goToStep(n) {
      var target = Math.min(Math.max(n, 1), TOTAL_STEPS);
      var dir = target > currentStep ? 'right' : 'left';
      showStep(target, dir);
    }

    function nextStep() {
      if (currentStep < TOTAL_STEPS) showStep(currentStep + 1, 'right');
    }

    function prevStep() {
      if (currentStep > 1) showStep(currentStep - 1, 'left');
    }

    function updateProgress() {
      var pct = Math.round((currentStep - 1) / (TOTAL_STEPS - 1) * 100);
      var bar = document.getElementById('progress-bar');
      var text = document.getElementById('progress-text');
      if (bar) bar.style.width = pct + '%';
      if (text) text.textContent = pct + '%';
    }

    function updateHeader() {
      var sub = document.getElementById('header-subtitle');
      if (!sub) return;
      var title = subtitleMap[currentStep] || 'En progreso';
      sub.textContent = 'Diapositiva ' + currentStep + ' - ' + title;
    }

    // Atajos teclado
    document.addEventListener('keydown', function(e) {
      var modal = document.getElementById('product-modal');
      var modalOpen = modal && modal.classList.contains('show');
      if (modalOpen) return;

      if (e.key === 'ArrowRight' || e.key === 'PageDown' || e.key === ' ') {
        e.preventDefault();
        nextStep();
      }
      if (e.key === 'ArrowLeft' || e.key === 'PageUp') {
        e.preventDefault();
        prevStep();
      }
      if (e.key === 'Home') goToStep(1);
      if (e.key === 'End') goToStep(TOTAL_STEPS);
    });

    // Touch/swipe soporte
    var touchStartX = 0;
    var touchStartY = 0;
    document.addEventListener('touchstart', function(e) {
      touchStartX = e.changedTouches[0].screenX;
      touchStartY = e.changedTouches[0].screenY;
    }, { passive: true });
    document.addEventListener('touchend', function(e) {
      var diffX = e.changedTouches[0].screenX - touchStartX;
      var diffY = e.changedTouches[0].screenY - touchStartY;
      if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 60) {
        if (diffX < 0) nextStep();
        else prevStep();
      }
    }, { passive: true });

    // ====== MODAL PRODUCTO ======
    function openProductModal(title, url) {
      var modal = document.getElementById('product-modal');
      var backdrop = document.getElementById('product-modal-backdrop');
      var closeBtn = document.getElementById('product-modal-close');
      var iframe = document.getElementById('product-modal-iframe');
      var ttl = document.getElementById('product-modal-title');
      var openNew = document.getElementById('product-modal-opennew');

      if (!modal || !backdrop || !closeBtn || !iframe || !ttl || !openNew) return;

      ttl.textContent = title || 'Producto Zython';
      iframe.src = url;
      openNew.href = url;

      modal.classList.add('show');
      modal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';

      closeBtn.focus();

      if (!modal.dataset.bound) {
        closeBtn.addEventListener('click', closeProductModal);
        backdrop.addEventListener('click', closeProductModal);
        document.addEventListener('keydown', function(e) {
          var isOpen = modal.classList.contains('show');
          if (!isOpen) return;
          if (e.key === 'Escape') closeProductModal();
        });
        modal.dataset.bound = '1';
      }
    }

    function closeProductModal() {
      var modal = document.getElementById('product-modal');
      var iframe = document.getElementById('product-modal-iframe');
      if (!modal || !iframe) return;

      modal.classList.remove('show');
      modal.setAttribute('aria-hidden', 'true');
      iframe.src = '';
      document.body.style.overflow = '';
    }

    // ====== INIT ======
    document.addEventListener('DOMContentLoaded', function() {
      createStars();
      createParticles();
      createCursorTrail();
      animateTrail();
      createSlideIndicator();
      showStep(1, 'right');
    });
  </script>
</body>
</html>
